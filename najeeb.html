<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
  />
  <title>AI Recommendations</title>
  <style>
    :root { --brand:#2c3e50; --ink:#1f2937; --muted:#6b7280; --bg:#ffffff; --card:#ffffff; --border:#e5e7eb; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    header{position:sticky;top:0;background:#fff;padding:14px 16px;border-bottom:1px solid var(--border);z-index:10}
    h1{font-size:18px;margin:0;color:var(--brand)}
    .container{padding:16px;max-width:720px;margin:0 auto}
    .search {display:flex;gap:8px;margin-bottom:12px}
    .search input, .search select{flex:1;padding:10px;border:1px solid var(--border);border-radius:12px;font-size:14px;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px;margin:10px 0;box-shadow:0 1px 3px rgba(0,0,0,0.06)}
    .row{margin:6px 0;font-size:14px}
    .row b{color:#000}
    .btn{margin-top:10px;padding:10px 14px;border:none;border-radius:12px;background:var(--brand);color:#fff;font-weight:600;font-size:14px;cursor:pointer}
    .btn.secondary{background:#111827}
    .hidden{display:none}
    table{width:100%;border-collapse:collapse;margin-top:10px;font-size:14px}
    th,td{border:1px solid var(--border);padding:10px;text-align:left}
    thead th{background:var(--brand);color:#fff}
    .hint{color:var(--muted);font-size:13px;margin:8px 2px}
    .pill{display:inline-block;padding:2px 8px;border:1px solid var(--border);border-radius:999px;font-size:12px;margin-left:6px;color:#374151}
    .form{margin-top:14px;display:grid;gap:10px}
    .feedback{width:100%;min-height:90px;padding:10px;border:1px solid var(--border);border-radius:12px;font-size:14px}
    .row.inline{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#111827;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;transition:opacity .2s}
    .toast.show{opacity:1}
    @media(min-width:768px){ body{display:flex;align-items:center;justify-content:center} .container{max-width:520px} }
    input[type="file"]{border:1px solid var(--border);border-radius:12px;padding:8px}
  </style>
  <!-- SheetJS (optional) for client-side Excel merge as a fallback -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <h1 id="title">AI Recommendations</h1>
    <div class="hint">Choose a customer and tap “View AI Recommended Products”.</div>
  </header>

  <div class="container" id="list-view">
    <div class="search">
      <input id="searchBox" placeholder="Search Customer or Code…"/>
      <select id="customerSelect">
        <option value="">All Customers</option>
      </select>
    </div>
    <div id="cards"></div>
  </div>

  <div class="container hidden" id="detail-view">
    <button class="btn secondary" id="backBtn">← Back</button>

    <div class="card">
      <div class="row"><b>Customer:</b> <span id="dCustomer"></span></div>
      <div class="row"><b>Customer Code:</b> <span id="dCode"></span></div>
    </div>

    <table>
      <thead>
        <tr><th style="width:70px">No.</th><th>AI Recommended Product</th></tr>
      </thead>
      <tbody id="recoBody"></tbody>
    </table>

    <div class="card form">
      <div class="row inline">
        <input id="visited" type="checkbox" />
        <label for="visited"><b>Customer Visited</b></label>
        <span class="pill" id="visitedStatus">No</span>
      </div>

      <textarea id="feedback" class="feedback" placeholder="Feedback (optional)…"></textarea>

      <div class="row inline" style="gap:8px;flex-wrap:wrap">
        <button class="btn" id="saveBtn">Save</button>
        <button class="btn secondary" id="exportBtn">Export Updates (CSV)</button>
      </div>

      <div class="hint">
        Saves to Google Sheet via your Apps Script endpoint. If the network or endpoint fails,
        your input is saved locally; you can export CSV or use the Excel merge below.
      </div>
    </div>

    <div class="card">
      <div class="row"><b>Excel Merge (Client-Side)</b></div>
      <div class="hint">Load your original Excel; we’ll merge local updates (Visited, Feedback) and download a new workbook. No server involved.</div>
      <div class="row inline">
        <input type="file" id="excelInput" accept=".xlsx,.xls" />
        <button class="btn" id="mergeBtn">Download Updated Excel</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>

  <script>
    /* ==== injected by builder ==== */
    const SALESMAN_NAME = "NAJEEB";
    const ROWS = [{"SALESMAN": "NAJEEB", "CUSTOMER": "SEVEN EMIRATES SUPERMARKET LLC", "Customer_code": "SHT/RTL/0152", "AI Recommended Product_1": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_5": "RK CUMIN SEED - 72 X 100 GM", "Cluster": "1", "Similar Outlets": "SHT/RTL/0380 (0.839); SHT/RTL/0320 (0.816); SHT/RTL/0772 (0.797); SHT/RTL/0919 (0.783); SHT/RTL/0617 (0.775)", "Recommended_Products": "['RK PR CHANA DAL - 16 X 1 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 6 X 2 KG', 'RK CUMIN SEED - 72 X 100 GM']", "Product Info": "RK PR CHANA DAL - 16 X 1 KG - Last purchase date: 05 May 2025, Lifetime sale qty: 3530 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: 23 May 2023, Lifetime sale qty: 100 BAG\nRK SUGAR - 5 KG - Last purchase date: 04 Jan 2025, Lifetime sale qty: 800 PCS\nRK SUGAR - 6 X 2 KG - Last purchase date: 15 Apr 2025, Lifetime sale qty: 2420 PCS\nRK CUMIN SEED - 72 X 100 GM - Last purchase date: 16 May 2025, Lifetime sale qty: 180 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS ALMADEENA HYPERMARKET LLC - BRANCH 04", "Customer_code": "SHT/RTL/0384", "AI Recommended Product_1": "RK PR Jeerakashala Rice 5kg", "AI Recommended Product_2": "RK PR MOONG DAL 16 X 1 KG", "AI Recommended Product_3": "RK BAY LEAVES - 24 X 50 GM", "AI Recommended Product_4": "RK PR SEMOLINA - 12 X 1 KG", "AI Recommended Product_5": "RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS", "Cluster": "2", "Similar Outlets": "SHT/RTL/0928 (0.754); SHT/RTL/1076 (0.717); SHT/RTL/0620 (0.713); SHT/RTL/0771 (0.712); SHT/RTL/0917 (0.704)", "Recommended_Products": "['RK PR Jeerakashala Rice 5kg', 'RK PR MOONG DAL 16 X 1 KG', 'RK BAY LEAVES - 24 X 50 GM', 'RK PR SEMOLINA - 12 X 1 KG', 'RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS']", "Product Info": "RK PR Jeerakashala Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MOONG DAL 16 X 1 KG - Last purchase date: 06 Dec 2024, Lifetime sale qty: 12 PCS\nRK BAY LEAVES - 24 X 50 GM - Last purchase date: 20 Mar 2025, Lifetime sale qty: 31 PCS\nRK PR SEMOLINA - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "HOME FRESH SUPER MARKET LLC", "Customer_code": "SHT/RTL/0451", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK SUGAR - 5 KG", "AI Recommended Product_3": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_4": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0592 (0.905); SHT/RTL/0619 (0.888); SHT/RTL/0889 (0.884); SHT/RTL/0621 (0.882); SHT/RTL/0556 (0.853)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK SUGAR - 6 X 2 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 28 Sep 2022, Lifetime sale qty: 200 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 6 X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 02 Jan 2025, Lifetime sale qty: 416 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "ONE TO TEN GIFTS - SOLE PROPRIETORSHIP L.L.C.", "Customer_code": "SHT/RTL/0478", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_3": "RK FINE TABLE SALT - 12 X 1 KG", "AI Recommended Product_4": "VERMICELLIES 777 (140GMX48PKT)", "AI Recommended Product_5": "RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG", "Cluster": "2", "Similar Outlets": "No similar outlets >=0.7", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 12 X 1 KG', 'RK FINE TABLE SALT - 12 X 1 KG', 'VERMICELLIES 777 (140GMX48PKT)', 'RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: 21 Nov 2023, Lifetime sale qty: 1626 PCS\nRK FINE TABLE SALT - 12 X 1 KG - Last purchase date: 17 Feb 2025, Lifetime sale qty: 8684 PCS\nVERMICELLIES 777 (140GMX48PKT) - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "ROYAL CITY MARKET  - OPC - LLC (AL FALAH)", "Customer_code": "SHT/RTL/0479", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "No similar outlets >=0.7", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 27 May 2023, Lifetime sale qty: 664 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 24 Nov 2023, Lifetime sale qty: 1760 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: 28 Jan 2023, Lifetime sale qty: 728 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 13 Nov 2023, Lifetime sale qty: 232 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "ROYAL GIFTS COLLECTION", "Customer_code": "SHT/RTL/0480", "AI Recommended Product_1": "RK PR TOOR DAL - 16 X 1 KG", "AI Recommended Product_2": "RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG", "AI Recommended Product_3": "RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG", "AI Recommended Product_4": "RK PR BASMATHI XXL RICE 8x2 KG", "AI Recommended Product_5": "RK PR STEAM PUTTU PODI 10 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0023 (0.865); SHT/RTL/1183 (0.855); SHT/RTL/1175 (0.846); SHT/RTL/0206 (0.844); SHT/RTL/1102 (0.844)", "Recommended_Products": "['RK PR TOOR DAL - 16 X 1 KG', 'RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG', 'RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG', 'RK PR BASMATHI XXL RICE 8x2 KG', 'RK PR STEAM PUTTU PODI 10 X 1 KG']", "Product Info": "RK PR TOOR DAL - 16 X 1 KG - Last purchase date: 24 May 2025, Lifetime sale qty: 224 PCS\nRK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: 25 Dec 2024, Lifetime sale qty: 32 PCS\nRK PR STEAM PUTTU PODI 10 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "ROYAL CITY MARKET - OPC LLC", "Customer_code": "SHT/RTL/0485", "AI Recommended Product_1": "RK CUMIN SEED - 72 X 100 GM", "AI Recommended Product_2": "RK PR CHAKKI ATTA -5 KG", "AI Recommended Product_3": "RK SOYA WADI - 20 X 200 GM", "AI Recommended Product_4": "RK SOYA WADI - 8 X 400 GM", "AI Recommended Product_5": "RK LONG CHILLY - 24 X 100 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/1084 (0.818); SHT/RTL/0395 (0.755); SHT/RTL/1082 (0.744); SHT/RTL/0892 (0.728); SHT/RTL/0757 (0.723)", "Recommended_Products": "['RK CUMIN SEED - 72 X 100 GM', 'RK PR CHAKKI ATTA -5 KG', 'RK SOYA WADI - 20 X 200 GM', 'RK SOYA WADI - 8 X 400 GM', 'RK LONG CHILLY - 24 X 100 GM']", "Product Info": "RK CUMIN SEED - 72 X 100 GM - Last purchase date: 12 May 2025, Lifetime sale qty: 1142 PCS\nRK PR CHAKKI ATTA -5 KG - Last purchase date: 17 Jul 2023, Lifetime sale qty: 42 PCS\nRK SOYA WADI - 20 X 200 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SOYA WADI - 8 X 400 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK LONG CHILLY - 24 X 100 GM - Last purchase date: 21 Apr 2025, Lifetime sale qty: 378 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "GRAND EMIRATES MARKET L.L.C", "Customer_code": "SHT/RTL/0494", "AI Recommended Product_1": "RK PR CHAKKI ATTA -5 KG", "AI Recommended Product_2": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_3": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_4": "RK PR TOOR DAL - 16 X 1 KG", "AI Recommended Product_5": "RK SUNFLOWER OIL - 6 X 1.5 LTR", "Cluster": "2", "Similar Outlets": "SHT/RTL/1183 (0.821); SHT/RTL/0088 (0.820); SHT/RTL/1102 (0.818); SHT/RTL/0854 (0.813); SHT/RTL/0584 (0.803)", "Recommended_Products": "['RK PR CHAKKI ATTA -5 KG', 'RK SUGAR - 6 X 2 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR TOOR DAL - 16 X 1 KG', 'RK SUNFLOWER OIL - 6 X 1.5 LTR']", "Product Info": "RK PR CHAKKI ATTA -5 KG - Last purchase date: 08 Dec 2024, Lifetime sale qty: 15 PCS\nRK SUGAR - 6 X 2 KG - Last purchase date: 25 Dec 2024, Lifetime sale qty: 3844 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: 06 Sep 2024, Lifetime sale qty: 292 PCS\nRK PR TOOR DAL - 16 X 1 KG - Last purchase date: 02 May 2025, Lifetime sale qty: 160 PCS\nRK SUNFLOWER OIL - 6 X 1.5 LTR - Last purchase date: 14 May 2025, Lifetime sale qty: 6 CTN, 108 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "SEVEN LAND SHOPPING CENTER", "Customer_code": "SHT/RTL/0498", "AI Recommended Product_1": "RK FINE TABLE SALT - 12 X 1 KG", "AI Recommended Product_2": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_3": "RK PR CHAKKI ATTA -5 KG", "AI Recommended Product_4": "RK PR SEMOLINA - 12 X 1 KG", "AI Recommended Product_5": "RK PR WHITE CHANA - 16 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/1146 (0.846); SHT/RTL/0654 (0.817); SHT/RTL/1083 (0.777); SHT/RTL/1012 (0.763); SHT/RTL/1015 (0.740)", "Recommended_Products": "['RK FINE TABLE SALT - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG', 'RK PR CHAKKI ATTA -5 KG', 'RK PR SEMOLINA - 12 X 1 KG', 'RK PR WHITE CHANA - 16 X 1 KG']", "Product Info": "RK FINE TABLE SALT - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHAKKI ATTA -5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR SEMOLINA - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR WHITE CHANA - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "VITAMIN SHAWARMA CAFE", "Customer_code": "SHT/RTL/0511", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "SHT/RTL/0910 (0.707)", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 30 Nov 2022, Lifetime sale qty: 10 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "JUMLA EXPRESS TRADING", "Customer_code": "SHT/RTL/0518", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG", "AI Recommended Product_3": "RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG", "AI Recommended Product_4": "RK BLACK PEPPER WHOLE - 72 X 100 GM", "AI Recommended Product_5": "RK CARDAMOM - 72 X 50 GM", "Cluster": "0", "Similar Outlets": "SHT/RTL/1103 (0.991); SHT/WS/0020 (0.990); VS/AUH/0126 (0.844); SHT/RTL/0852 (0.800); SHT/RTL/0524 (0.791)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG', 'RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG', 'RK BLACK PEPPER WHOLE - 72 X 100 GM', 'RK CARDAMOM - 72 X 50 GM']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK BLACK PEPPER WHOLE - 72 X 100 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK CARDAMOM - 72 X 50 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "SUPER MARKET GRANITE LLC BR.2", "Customer_code": "SHT/RTL/0524", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "THAI US STYLE RICE - 777 - 5KG", "AI Recommended Product_3": "THAI US STYLE RICE - 777 - 10 KG", "AI Recommended Product_4": "THAI US STYLE RICE - 777 - 20 KG", "AI Recommended Product_5": "", "Cluster": "0", "Similar Outlets": "SHT/RTL/1103 (0.798); SHT/WS/0020 (0.798); SHT/RTL/0518 (0.791)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'THAI US STYLE RICE - 777 - 5KG', 'THAI US STYLE RICE - 777 - 10 KG', 'THAI US STYLE RICE - 777 - 20 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nTHAI US STYLE RICE - 777 - 5KG - Last purchase date: 20 Jun 2023, Lifetime sale qty: 20 BAG\nTHAI US STYLE RICE - 777 - 10 KG - Last purchase date: 24 Aug 2022, Lifetime sale qty: 5 BAG\nTHAI US STYLE RICE - 777 - 20 KG - Last purchase date: 04 Oct 2022, Lifetime sale qty: 4 BAG"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "GRANITE SUPERMARKET LLC", "Customer_code": "SHT/RTL/0534", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_5": "RK PR KALA CHANA - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "No similar outlets >=0.7", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK PR CHANA DAL - 16 X 1 KG', 'RK PR KALA CHANA - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 26 Jun 2024, Lifetime sale qty: 156 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 19 Jul 2022, Lifetime sale qty: 10 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 19 Nov 2022, Lifetime sale qty: 14 PCS\nRK PR KALA CHANA - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "NEW DAY MART HYPERMARKET L.L.C.", "Customer_code": "SHT/RTL/0556", "AI Recommended Product_1": "RK SUGAR - 5 KG", "AI Recommended Product_2": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_3": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_4": "RK PR Palakkadan Matta Rice 5kg", "AI Recommended Product_5": "RK PR BASMATHI XXL RICE 8x2 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0451 (0.853); SHT/RTL/0490 (0.806); SHT/RTL/0619 (0.804); SHT/RTL/0592 (0.797); SHT/RTL/0889 (0.797)", "Recommended_Products": "['RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK PR Palakkadan Matta Rice 5kg', 'RK PR BASMATHI XXL RICE 8x2 KG']", "Product Info": "RK SUGAR - 5 KG - Last purchase date: 07 Feb 2025, Lifetime sale qty: 270 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: 04 Feb 2025, Lifetime sale qty: 336 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR Palakkadan Matta Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "MAJESTIC SUPERMARKET", "Customer_code": "SHT/RTL/0567", "AI Recommended Product_1": "RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG", "AI Recommended Product_2": "RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG", "AI Recommended Product_3": "RK GREEN PEAS - 16 X 1 KG", "AI Recommended Product_4": "RK PR URAD DAL - 16 X 1 KG", "AI Recommended Product_5": "RK PR BOTTLE COMBO (CTC) - 3 X 160 GM", "Cluster": "0", "Similar Outlets": "SHT/RTL/0463 (0.737); SHT/RTL/1181 (0.710); SHT/RTL/1180 (0.707)", "Recommended_Products": "['RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG', 'RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG', 'RK GREEN PEAS - 16 X 1 KG', 'RK PR URAD DAL - 16 X 1 KG', 'RK PR BOTTLE COMBO (CTC) - 3 X 160 GM']", "Product Info": "RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK GREEN PEAS - 16 X 1 KG - Last purchase date: 21 Dec 2022, Lifetime sale qty: 16 PCS\nRK PR URAD DAL - 16 X 1 KG - Last purchase date: 10 Sep 2024, Lifetime sale qty: 32 PCS\nRK PR BOTTLE COMBO (CTC) - 3 X 160 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "A ONE SUPERMARKET L.L.C", "Customer_code": "SHT/RTL/0619", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK PR MASOOR DAL - 16 X 1 KG", "AI Recommended Product_3": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_4": "RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG", "AI Recommended Product_5": "RK PR Sonamasoori Rice 5kg", "Cluster": "2", "Similar Outlets": "SHT/RTL/0621 (0.929); SHT/RTL/0592 (0.926); SHT/RTL/0889 (0.898); SHT/RTL/0451 (0.888); SHT/RTL/1020 (0.840)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK PR MASOOR DAL - 16 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG', 'RK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG', 'RK PR Sonamasoori Rice 5kg']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MASOOR DAL - 16 X 1 KG - Last purchase date: 23 May 2025, Lifetime sale qty: 640 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 23 May 2025, Lifetime sale qty: 192 PCS\nRK PR JEERAKASHALA (GHEE RICE ) - 9X 2 KG - Last purchase date: 25 Mar 2025, Lifetime sale qty: 63 PCS\nRK PR Sonamasoori Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "GRAND MAJESTIC HYPERMARKET", "Customer_code": "SHT/RTL/0621", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK PR MASOOR DAL - 16 X 1 KG", "AI Recommended Product_3": "RK PR Jeerakashala Rice 5kg", "AI Recommended Product_4": "RK PR BASMATHI XXL RICE 8x2 KG", "AI Recommended Product_5": "RK PR KALA CHANA - 16 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0619 (0.929); SHT/RTL/0889 (0.915); SHT/RTL/0451 (0.882); SHT/RTL/0592 (0.880); SHT/RTL/0490 (0.872)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK PR MASOOR DAL - 16 X 1 KG', 'RK PR Jeerakashala Rice 5kg', 'RK PR BASMATHI XXL RICE 8x2 KG', 'RK PR KALA CHANA - 16 X 1 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MASOOR DAL - 16 X 1 KG - Last purchase date: 15 Dec 2022, Lifetime sale qty: 144 PCS\nRK PR Jeerakashala Rice 5kg - Last purchase date: 25 Mar 2025, Lifetime sale qty: 180 PCS\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR KALA CHANA - 16 X 1 KG - Last purchase date: 02 Jan 2025, Lifetime sale qty: 96 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "WIDE AL ALAMIAH GENERAL TRADING LLC", "Customer_code": "SHT/RTL/0653", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "2", "Similar Outlets": "Customer not made purchase in last 3 months", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 26 Aug 2024, Lifetime sale qty: 282 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 21 Aug 2024, Lifetime sale qty: 135 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: 23 Jul 2024, Lifetime sale qty: 360 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "PARCO SUPERMARKET L L BRANCH - 1", "Customer_code": "SHT/RTL/0684", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK PR BESAN POWDER- 10 X 1 KG", "AI Recommended Product_3": "RK PR BASMATHI XXL RICE 8x2 KG", "AI Recommended Product_4": "RK PR BOTTLE COMBO (CTC) - 3 X 160 GM", "AI Recommended Product_5": "RK URAD SPLIT - 32 X 500 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/0950 (0.851); SHT/RTL/0557 (0.769); SHT/RTL/1022 (0.745); SHT/RTL/0280 (0.744); SHT/RTL/0514 (0.731)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK PR BESAN POWDER- 10 X 1 KG', 'RK PR BASMATHI XXL RICE 8x2 KG', 'RK PR BOTTLE COMBO (CTC) - 3 X 160 GM', 'RK URAD SPLIT - 32 X 500 GM']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BESAN POWDER- 10 X 1 KG - Last purchase date: 26 Mar 2025, Lifetime sale qty: 360 PCS\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BOTTLE COMBO (CTC) - 3 X 160 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK URAD SPLIT - 32 X 500 GM - Last purchase date: 02 Apr 2025, Lifetime sale qty: 22 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "PARCO HYPER MARKET LLC - BRANCH 1", "Customer_code": "SHT/RTL/0788", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR Palakkadan Matta Rice 5kg", "AI Recommended Product_3": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_4": "RK PR Sonamasoori Rice 5kg", "AI Recommended Product_5": "RK PR BASMATHI XXL RICE 8x2 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0619 (0.823); SHT/RTL/0621 (0.809); SHT/RTL/0490 (0.790); SHT/RTL/0592 (0.780); SHT/RTL/1020 (0.773)", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR Palakkadan Matta Rice 5kg', 'RK PR CHANA DAL - 16 X 1 KG', 'RK PR Sonamasoori Rice 5kg', 'RK PR BASMATHI XXL RICE 8x2 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 07 May 2025, Lifetime sale qty: 5834 PCS\nRK PR Palakkadan Matta Rice 5kg - Last purchase date: 19 May 2025, Lifetime sale qty: 15 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 04 Oct 2024, Lifetime sale qty: 440 PCS\nRK PR Sonamasoori Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "PARCO SUPERMARKET L.L.C. - BRANCH 2", "Customer_code": "SHT/RTL/0801", "AI Recommended Product_1": "RK PR Palakkadan Matta Rice 5kg", "AI Recommended Product_2": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_3": "RK BOX KASURI METHI - 72 X 50 GM", "AI Recommended Product_4": "RK FENNEL SEED - 72 X 100 GM", "AI Recommended Product_5": "RK GARAM MASALA WHOLE - 48 X 100 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/1010 (0.801)", "Recommended_Products": "['RK PR Palakkadan Matta Rice 5kg', 'RK SUGAR - 12 X 1 KG', 'RK BOX KASURI METHI - 72 X 50 GM', 'RK FENNEL SEED - 72 X 100 GM', 'RK GARAM MASALA WHOLE - 48 X 100 GM']", "Product Info": "RK PR Palakkadan Matta Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: 09 Sep 2024, Lifetime sale qty: 408 PCS\nRK BOX KASURI METHI - 72 X 50 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK FENNEL SEED - 72 X 100 GM - Last purchase date: 24 Oct 2024, Lifetime sale qty: 146 PCS\nRK GARAM MASALA WHOLE - 48 X 100 GM - Last purchase date: 24 Oct 2024, Lifetime sale qty: 414 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "MESTO GENERAL TRADING - L.L.C", "Customer_code": "SHT/RTL/0903", "AI Recommended Product_1": "RK SOYA WADI - 20 X 200 GM", "AI Recommended Product_2": "", "AI Recommended Product_3": "", "AI Recommended Product_4": "", "AI Recommended Product_5": "", "Cluster": "0", "Similar Outlets": "SHT/RTL/1119 (0.985); VS/AJM/0364 (0.985); SHT/RTL/1104 (0.967)", "Recommended_Products": "['RK SOYA WADI - 20 X 200 GM']", "Product Info": "RK SOYA WADI - 20 X 200 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS ALMADEENA HYPERMARKET LLC - BRANCH 01", "Customer_code": "SHT/RTL/0906", "AI Recommended Product_1": "RK FINE TABLE SALT - 12 X 1 KG", "AI Recommended Product_2": "RK SUGAR - 5 KG", "AI Recommended Product_3": "RK PR MOONG DAL 16 X 1 KG", "AI Recommended Product_4": "RK PR SEMOLINA - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHAKKI ATTA -10 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/MT/0035 (0.817); SHT/RTL/0793 (0.790); SHT/RTL/1076 (0.756); SHT/RTL/0034 (0.750); SHT/RTL/0445 (0.748)", "Recommended_Products": "['RK FINE TABLE SALT - 12 X 1 KG', 'RK SUGAR - 5 KG', 'RK PR MOONG DAL 16 X 1 KG', 'RK PR SEMOLINA - 12 X 1 KG', 'RK PR CHAKKI ATTA -10 KG']", "Product Info": "RK FINE TABLE SALT - 12 X 1 KG - Last purchase date: 08 Jan 2025, Lifetime sale qty: 156 PCS\nRK SUGAR - 5 KG - Last purchase date: 17 May 2025, Lifetime sale qty: 250 PCS\nRK PR MOONG DAL 16 X 1 KG - Last purchase date: 01 Sep 2024, Lifetime sale qty: 48 PCS\nRK PR SEMOLINA - 12 X 1 KG - Last purchase date: 10 Oct 2024, Lifetime sale qty: 12 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS ALMADEENA HYPERMARKET LLC - BRANCH 06", "Customer_code": "SHT/RTL/0909", "AI Recommended Product_1": "RK PR MOONG DAL 16 X 1 KG", "AI Recommended Product_2": "RK PR SEMOLINA - 12 X 1 KG", "AI Recommended Product_3": "RK PR STEAM PUTTU PODI 10 X 1 KG", "AI Recommended Product_4": "RK ROASTED SEMOLINA (RAVA) - 10 X 1 KG", "AI Recommended Product_5": "RK PR TUKH MALANGA -72 X 100 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/0593 (0.799); SHT/RTL/1129 (0.787); SHT/RTL/0171 (0.787); SHT/RTL/0160 (0.784); SHT/RTL/0928 (0.780)", "Recommended_Products": "['RK PR MOONG DAL 16 X 1 KG', 'RK PR SEMOLINA - 12 X 1 KG', 'RK PR STEAM PUTTU PODI 10 X 1 KG', 'RK ROASTED SEMOLINA (RAVA) - 10 X 1 KG', 'RK PR TUKH MALANGA -72 X 100 GM']", "Product Info": "RK PR MOONG DAL 16 X 1 KG - Last purchase date: 18 Apr 2025, Lifetime sale qty: 382 PCS\nRK PR SEMOLINA - 12 X 1 KG - Last purchase date: 05 Feb 2025, Lifetime sale qty: 290 PCS\nRK PR STEAM PUTTU PODI 10 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK ROASTED SEMOLINA (RAVA) - 10 X 1 KG - Last purchase date: 16 Nov 2024, Lifetime sale qty: 20 PCS\nRK PR TUKH MALANGA -72 X 100 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "KK ROAD EXPRESS RESTUARENT", "Customer_code": "SHT/RTL/0910", "AI Recommended Product_1": "RK PR Basmathi Rice 5kg", "AI Recommended Product_2": "", "AI Recommended Product_3": "", "AI Recommended Product_4": "", "AI Recommended Product_5": "", "Cluster": "0", "Similar Outlets": "SHT/RTL/0511 (0.707)", "Recommended_Products": "['RK PR Basmathi Rice 5kg']", "Product Info": "RK PR Basmathi Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS AL MADEENA HYPERMARKET LLC - BRANCH , MUROOR", "Customer_code": "SHT/RTL/0917", "AI Recommended Product_1": "RK PR TURMERIC POWDER - 48 X 200 GM", "AI Recommended Product_2": "RK SOYA WADI - 20 X 200 GM", "AI Recommended Product_3": "RK PR Palakkadan Matta Rice 5kg", "AI Recommended Product_4": "RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS", "AI Recommended Product_5": "RK PR CHILLY POWDER - 48 X 200 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/0928 (0.867); SHT/RTL/1076 (0.846); SHT/RTL/0908 (0.838); SHT/RTL/0922 (0.823); SHT/RTL/0792 (0.752)", "Recommended_Products": "['RK PR TURMERIC POWDER - 48 X 200 GM', 'RK SOYA WADI - 20 X 200 GM', 'RK PR Palakkadan Matta Rice 5kg', 'RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS', 'RK PR CHILLY POWDER - 48 X 200 GM']", "Product Info": "RK PR TURMERIC POWDER - 48 X 200 GM - Last purchase date: 10 Jan 2024, Lifetime sale qty: 48 PCS\nRK SOYA WADI - 20 X 200 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR Palakkadan Matta Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHILLY POWDER - 48 X 200 GM - Last purchase date: 26 Dec 2024, Lifetime sale qty: 120 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS ALMADEENA HYPERMARKET LLC - Branch - 07", "Customer_code": "SHT/RTL/0928", "AI Recommended Product_1": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_2": "RK PR Palakkadan Matta Rice 5kg", "AI Recommended Product_3": "RK PR Jeerakashala Rice 5kg", "AI Recommended Product_4": "RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS", "AI Recommended Product_5": "RK SOYA WADI - 20 X 200 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/1076 (0.892); SHT/RTL/0917 (0.867); SHT/RTL/0790 (0.833); SHT/RTL/0027 (0.783); SHT/RTL/0792 (0.781)", "Recommended_Products": "['RK SUGAR - 12 X 1 KG', 'RK PR Palakkadan Matta Rice 5kg', 'RK PR Jeerakashala Rice 5kg', 'RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS', 'RK SOYA WADI - 20 X 200 GM']", "Product Info": "RK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR Palakkadan Matta Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR Jeerakashala Rice 5kg - Last purchase date: No purchases, Lifetime sale qty: 0\nRK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SOYA WADI - 20 X 200 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "GRAND EMIRATES MARKET L.L.C - BRANCH", "Customer_code": "SHT/RTL/0932", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_3": "VERMICELLIES 777 (140GMX48PKT)", "AI Recommended Product_4": "RK PUFFED RICE (KURMURA) - 6 X 300 GM", "AI Recommended Product_5": "RK PR BASMATHI XXL RICE 8x2 KG", "Cluster": "1", "Similar Outlets": "No similar outlets >=0.7", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHANA DAL - 16 X 1 KG', 'VERMICELLIES 777 (140GMX48PKT)', 'RK PUFFED RICE (KURMURA) - 6 X 300 GM', 'RK PR BASMATHI XXL RICE 8x2 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 12 Apr 2025, Lifetime sale qty: 2640 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 10 May 2025, Lifetime sale qty: 768 PCS\nVERMICELLIES 777 (140GMX48PKT) - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PUFFED RICE (KURMURA) - 6 X 300 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "MAJESTIC PLUS HYPERMARKET L.L.C", "Customer_code": "SHT/RTL/0935", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "Customer not made purchase in last 3 months", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: 17 Apr 2025, Lifetime sale qty: 266 PCS\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: 29 May 2024, Lifetime sale qty: 110 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: 21 Apr 2025, Lifetime sale qty: 386 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 26 Mar 2025, Lifetime sale qty: 128 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS AL MADEENA HYPERMARKET LLC - BRANCH 9", "Customer_code": "SHT/RTL/1076", "AI Recommended Product_1": "RK PR WHITE CHANA - 16 X 1 KG", "AI Recommended Product_2": "RK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG", "AI Recommended Product_3": "RK SUNFLOWER OIL - 6 X 1.5 LTR", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR SEMOLINA - 12 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0928 (0.892); SHT/RTL/0917 (0.846); SHT/RTL/0789 (0.805); SHT/RTL/0027 (0.800); SHT/RTL/0790 (0.800)", "Recommended_Products": "['RK PR WHITE CHANA - 16 X 1 KG', 'RK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG', 'RK SUNFLOWER OIL - 6 X 1.5 LTR', 'RK SUGAR - 12 X 1 KG', 'RK PR SEMOLINA - 12 X 1 KG']", "Product Info": "RK PR WHITE CHANA - 16 X 1 KG - Last purchase date: 30 Apr 2025, Lifetime sale qty: 256 PCS\nRK PR ROASTED SEMOLINA (RAVA) - 10 X 1 KG - Last purchase date: 06 Mar 2025, Lifetime sale qty: 30 PCS\nRK SUNFLOWER OIL - 6 X 1.5 LTR - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR SEMOLINA - 12 X 1 KG - Last purchase date: 20 Mar 2025, Lifetime sale qty: 114 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "EXPRESS AL MADEENA HYPERMARKET, BR-10", "Customer_code": "SHT/RTL/1097", "AI Recommended Product_1": "RK PR MOONG DAL 16 X 1 KG", "AI Recommended Product_2": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_3": "RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG", "AI Recommended Product_4": "RK SOYA WADI - 20 X 200 GM", "AI Recommended Product_5": "RK CHANA DAL - 32 X 500 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/1175 (0.952); SHT/RTL/1009 (0.949); SHT/RTL/0206 (0.948); SHT/RTL/1102 (0.943); SHT/RTL/1098 (0.942)", "Recommended_Products": "['RK PR MOONG DAL 16 X 1 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG', 'RK SOYA WADI - 20 X 200 GM', 'RK CHANA DAL - 32 X 500 GM']", "Product Info": "RK PR MOONG DAL 16 X 1 KG - Last purchase date: 14 Dec 2024, Lifetime sale qty: 48 PCS\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR LONG GRAIN BIRIYANI RICE - 5 X 5KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SOYA WADI - 20 X 200 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK CHANA DAL - 32 X 500 GM - Last purchase date: 23 May 2025, Lifetime sale qty: 40 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "FALAK HYPERMARKET LLC", "Customer_code": "SHT/RTL/1104", "AI Recommended Product_1": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_2": "", "AI Recommended Product_3": "", "AI Recommended Product_4": "", "AI Recommended Product_5": "", "Cluster": "0", "Similar Outlets": "SHT/RTL/0903 (0.967); SHT/RTL/1119 (0.956); VS/AJM/0364 (0.956)", "Recommended_Products": "['RK SUGAR - 12 X 1 KG']", "Product Info": "RK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "SEVEN EMIRATES SUPERMARKET - LLC BRANCH -1", "Customer_code": "SHT/RTL/1135", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "RK PR BESAN POWDER -24 X 400 GM", "AI Recommended Product_3": "RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS", "AI Recommended Product_4": "RK ROASTED SEMOLINA (RAVA) - 10 X 1 KG", "AI Recommended Product_5": "RK MASOOR WHOLE - 16 X 1 KG", "Cluster": "2", "Similar Outlets": "SHT/RTL/0160 (0.871); VS/DXB/DTL/0494 (0.840); SHT/RTL/1129 (0.839); SHT/RTL/0791 (0.838); SHT/RTL/0444 (0.838)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'RK PR BESAN POWDER -24 X 400 GM', 'RK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS', 'RK ROASTED SEMOLINA (RAVA) - 10 X 1 KG', 'RK MASOOR WHOLE - 16 X 1 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BESAN POWDER -24 X 400 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK KERALA PAPPAD FAMILY PACK - 1 X 35 PCS - Last purchase date: 14 Feb 2025, Lifetime sale qty: 12 PCS\nRK ROASTED SEMOLINA (RAVA) - 10 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK MASOOR WHOLE - 16 X 1 KG - Last purchase date: 27 Feb 2025, Lifetime sale qty: 20 PCS"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "BAQALA WIDE ALAMIAH - L.L.C", "Customer_code": "SHT/RTL/1159", "AI Recommended Product_1": "RK PR CHAKKI ATTA -5 KG", "AI Recommended Product_2": "RK PR KALA CHANA - 16 X 1 KG", "AI Recommended Product_3": "RK PR CHANA DAL - 16 X 1 KG", "AI Recommended Product_4": "RK PR MASOOR DAL - 16 X 1 KG", "AI Recommended Product_5": "RK PR FINE TABLE SALT (COMBO BOTTLE) - 3 X 700 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/1102 (0.837); SHT/RTL/1098 (0.835); SHT/RTL/1175 (0.825); SHT/RTL/0805 (0.816); SHT/RTL/0206 (0.815)", "Recommended_Products": "['RK PR CHAKKI ATTA -5 KG', 'RK PR KALA CHANA - 16 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG', 'RK PR MASOOR DAL - 16 X 1 KG', 'RK PR FINE TABLE SALT (COMBO BOTTLE) - 3 X 700 GM']", "Product Info": "RK PR CHAKKI ATTA -5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR KALA CHANA - 16 X 1 KG - Last purchase date: 14 May 2025, Lifetime sale qty: 32 PCS\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: 07 Apr 2025, Lifetime sale qty: 16 PCS\nRK PR MASOOR DAL - 16 X 1 KG - Last purchase date: 14 May 2025, Lifetime sale qty: 64 PCS\nRK PR FINE TABLE SALT (COMBO BOTTLE) - 3 X 700 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "PARCO SUPERMARKET LLC", "Customer_code": "SHT/RTL/1177", "AI Recommended Product_1": "RK SUGAR - 5 KG", "AI Recommended Product_2": "RK PR MASOOR DAL - 16 X 1 KG", "AI Recommended Product_3": "RK PR BASMATHI XXL RICE 8x2 KG", "AI Recommended Product_4": "RK MASOOR DAL - 32 X 500 GM", "AI Recommended Product_5": "RK MOONG DAL - 32 X 500 GM", "Cluster": "2", "Similar Outlets": "SHT/RTL/0085 (0.887); SHT/RTL/MT/0104 (0.842); SHT/RTL/1038 (0.807); SHT/RTL/1094 (0.800); SHT/RTL/0220 (0.795)", "Recommended_Products": "['RK SUGAR - 5 KG', 'RK PR MASOOR DAL - 16 X 1 KG', 'RK PR BASMATHI XXL RICE 8x2 KG', 'RK MASOOR DAL - 32 X 500 GM', 'RK MOONG DAL - 32 X 500 GM']", "Product Info": "RK SUGAR - 5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MASOOR DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR BASMATHI XXL RICE 8x2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK MASOOR DAL - 32 X 500 GM - Last purchase date: No purchases, Lifetime sale qty: 0\nRK MOONG DAL - 32 X 500 GM - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "NAHAR AL MADEENA FRESH MART L.L.C.", "Customer_code": "SHT/RTL/1201", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "No similar outlets >=0.7", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "ROYAL CITY MARKET - L.L.C - O.P.C - BRANCH", "Customer_code": "SHT/RTL/1204", "AI Recommended Product_1": "RK PR SEMOLINA - 12 X 1 KG", "AI Recommended Product_2": "RK PR MOONG DAL 16 X 1 KG", "AI Recommended Product_3": "RK PR MOONG WHOLE -16 X 1 KG", "AI Recommended Product_4": "RK PR WHITE CHANA - 16 X 1 KG", "AI Recommended Product_5": "RK PR RED KIDNEY BEANS 16 X 1KG", "Cluster": "0", "Similar Outlets": "SHT/RTL/1068 (0.719)", "Recommended_Products": "['RK PR SEMOLINA - 12 X 1 KG', 'RK PR MOONG DAL 16 X 1 KG', 'RK PR MOONG WHOLE -16 X 1 KG', 'RK PR WHITE CHANA - 16 X 1 KG', 'RK PR RED KIDNEY BEANS 16 X 1KG']", "Product Info": "RK PR SEMOLINA - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MOONG DAL 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR MOONG WHOLE -16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR WHITE CHANA - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR RED KIDNEY BEANS 16 X 1KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "BAQALA NEW YATHRIB GROCERY", "Customer_code": "VS/AUH/0053", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "Customer not made purchase in last 3 months", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "AL GHABAT CITY SUPERMARKET", "Customer_code": "VS/AUH/0126", "AI Recommended Product_1": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_2": "THAI US STYLE RICE - 777 - 10 KG", "AI Recommended Product_3": "THAI US STYLE RICE - 777 - 20 KG", "AI Recommended Product_4": "", "AI Recommended Product_5": "", "Cluster": "0", "Similar Outlets": "SHT/RTL/1103 (0.845); SHT/WS/0020 (0.845); SHT/RTL/0518 (0.844)", "Recommended_Products": "['RK PR CHAKKI ATTA -10 KG', 'THAI US STYLE RICE - 777 - 10 KG', 'THAI US STYLE RICE - 777 - 20 KG']", "Product Info": "RK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nTHAI US STYLE RICE - 777 - 10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nTHAI US STYLE RICE - 777 - 20 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}, {"SALESMAN": "NAJEEB", "CUSTOMER": "SANAA YEMENI PRODUCTS", "Customer_code": "VS/AUH/0129", "AI Recommended Product_1": "RK SUGAR - 6 X 2 KG", "AI Recommended Product_2": "RK PR CHAKKI ATTA -10 KG", "AI Recommended Product_3": "RK SUGAR - 5 KG", "AI Recommended Product_4": "RK SUGAR - 12 X 1 KG", "AI Recommended Product_5": "RK PR CHANA DAL - 16 X 1 KG", "Cluster": "0", "Similar Outlets": "Customer not made purchase in last 3 months", "Recommended_Products": "['RK SUGAR - 6 X 2 KG', 'RK PR CHAKKI ATTA -10 KG', 'RK SUGAR - 5 KG', 'RK SUGAR - 12 X 1 KG', 'RK PR CHANA DAL - 16 X 1 KG']", "Product Info": "RK SUGAR - 6 X 2 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHAKKI ATTA -10 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 5 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK SUGAR - 12 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0\nRK PR CHANA DAL - 16 X 1 KG - Last purchase date: No purchases, Lifetime sale qty: 0"}];
    const SAVE_ENDPOINT = "https://script.google.com/a/macros/datadivr.com/s/AKfycbyvH1Qn4jP1JB_D1yImAWeDnNI828KtqqWTFyAe9eY5g8F27HxriEX_Fn2e2MRpKS4v/exec"; // e.g., "https://script.google.com/macros/s/…/exec"

    /* ==== elements ==== */
    const listView = document.getElementById('list-view');
    const detailView = document.getElementById('detail-view');
    const cards = document.getElementById('cards');
    const searchBox = document.getElementById('searchBox');
    const customerSelect = document.getElementById('customerSelect');
    const title = document.getElementById('title');
    const visitedEl = document.getElementById('visited');
    const visitedStatus = document.getElementById('visitedStatus');
    const feedbackEl = document.getElementById('feedback');
    const recoBody = document.getElementById('recoBody');
    const toast = document.getElementById('toast');

    title.textContent = `AI Recommendations — ${SALESMAN_NAME}`;

    /* ==== customer list filters ==== */
    const uniqueCustomers = [...new Map(
      ROWS.map(r => [r.CUSTOMER + '|' + r.Customer_code, {CUSTOMER:r.CUSTOMER, Customer_code:r.Customer_code}])
    ).values()];

    function populateSelect() {
      customerSelect.innerHTML = '<option value="">All Customers</option>';
      uniqueCustomers.forEach(u => {
        const opt = document.createElement('option');
        opt.value = u.CUSTOMER + '|' + u.Customer_code;
        opt.textContent = `${u.CUSTOMER} (${u.Customer_code})`;
        customerSelect.appendChild(opt);
      });
    }
    populateSelect();

    function renderCards() {
      const q = (searchBox.value || '').toLowerCase();
      const sel = customerSelect.value;

      const groups = {};
      for (const r of ROWS) {
        const key = r.CUSTOMER + '|' + r.Customer_code;
        if (sel && key !== sel) continue;
        if (q && !(r.CUSTOMER.toLowerCase().includes(q) || String(r.Customer_code).toLowerCase().includes(q))) continue;
        if (!groups[key]) groups[key] = r;
      }

      cards.innerHTML = '';
      Object.values(groups).forEach(r => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="row"><b>Customer:</b> ${r.CUSTOMER}</div>
          <div class="row"><b>Customer Code:</b> ${r.Customer_code}</div>
          <button class="btn">View AI Recommended Products</button>
        `;
        card.querySelector('button').addEventListener('click', () => openDetail(r));
        cards.appendChild(card);
      });
    }
    searchBox.addEventListener('input', renderCards);
    customerSelect.addEventListener('change', renderCards);

    /* ==== local fallback storage ==== */
    const STORAGE_KEY = `ai-reco-updates::${SALESMAN_NAME}`;
    function loadLocalUpdates() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { return {}; }
    }
    function saveLocalUpdates(map) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(map));
    }
    function toCSV(map) {
      const rows = [['SALESMAN','CUSTOMER','Customer_code','Visited','Feedback']];
      Object.values(map).forEach(m => {
        rows.push([m.SALESMAN, m.CUSTOMER, m.Customer_code, m.Visited, (m.Feedback||'').replaceAll('\\n',' ').trim()]);
      });
      return rows.map(r => r.map(v => `"${String(v).replaceAll('"','""')}"`).join(',')).join('\\n');
    }

    let currentRow = null;

    function showToast(msg='Saved') {
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1400);
    }

    function openDetail(row){
      listView.classList.add('hidden');
      detailView.classList.remove('hidden');

      currentRow = row;
      document.getElementById('dCustomer').textContent = row.CUSTOMER || '-';
      document.getElementById('dCode').textContent = row.Customer_code || '-';

      const fields = ['AI Recommended Product_1','AI Recommended Product_2','AI Recommended Product_3','AI Recommended Product_4','AI Recommended Product_5'];
      recoBody.innerHTML = '';
      fields.forEach((f, idx) => {
        const val = (row[f] ?? '').toString().trim();
        if (val) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${idx+1}</td><td>${val}</td>`;
          recoBody.appendChild(tr);
        }
      });

      // prefill from local state if exists
      const map = loadLocalUpdates();
      const rec = map[row.Customer_code];
      const visited = rec ? (rec.Visited === 'Yes') : false;
      visitedEl.checked = visited;
      visitedStatus.textContent = visited ? 'Yes' : 'No';
      feedbackEl.value = rec ? (rec.Feedback || '') : '';
    }

    visitedEl.addEventListener('change', () => {
      visitedStatus.textContent = visitedEl.checked ? 'Yes' : 'No';
    });

    async function persist(update) {
      // Try Google Apps Script endpoint first
      try {
        const res = await fetch(SAVE_ENDPOINT, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(update),
          mode: 'cors',
        });
        if (!res.ok) throw new Error(await res.text());
        showToast('Saved to Sheet');
        return true;
      } catch (e) {
        console.warn('Remote save failed, saving locally instead:', e);
        const map = loadLocalUpdates();
        map[update.Customer_code] = update;
        saveLocalUpdates(map);
        showToast('Saved locally (offline fallback)');
        return false;
      }
    }

    document.getElementById('saveBtn').addEventListener('click', () => {
      if (!currentRow) return;
      const payload = {
        SALESMAN: SALESMAN_NAME,
        CUSTOMER: currentRow.CUSTOMER,
        Customer_code: currentRow.Customer_code,
        Visited: visitedEl.checked ? 'Yes' : 'No',
        Feedback: feedbackEl.value || ''
      };
      persist(payload);
    });

    document.getElementById('exportBtn').addEventListener('click', () => {
      const csv = toCSV(loadLocalUpdates());
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `updates_${SALESMAN_NAME.replaceAll(' ','_')}.csv`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    document.getElementById('backBtn').addEventListener('click', () => {
      detailView.classList.add('hidden');
      listView.classList.remove('hidden');
      window.scrollTo({top:0, behavior:'instant'});
    });

    /* ==== Client-side Excel merge (fallback) ==== */
    let excelFile = null;
    document.getElementById('excelInput').addEventListener('change', (e) => {
      excelFile = e.target.files[0] || null;
      if (excelFile) showToast('Excel loaded. Ready to merge.');
    });

    document.getElementById('mergeBtn').addEventListener('click', () => {
      if (!excelFile) { showToast('Choose the original Excel first'); return; }
      const reader = new FileReader();
      reader.onload = (e) => {
        const data = new Uint8Array(e.target.result);
        const wb = XLSX.read(data, {type:'array'});
        const wsName = wb.SheetNames[0];
        const ws = wb.Sheets[wsName];
        const df = XLSX.utils.sheet_to_json(ws, {defval:""});

        const key = (r) => String(r['SALESMAN']||'') + '||' + String(r['Customer_code']||'');
        const indexMap = new Map();
        df.forEach((row, i) => indexMap.set(key(row), i));

        const updates = loadLocalUpdates();
        Object.values(updates).forEach(u => {
          const k = String(u.SALESMAN||'') + '||' + String(u.Customer_code||'');
          if (indexMap.has(k)) {
            const i = indexMap.get(k);
            df[i]['Visited'] = u.Visited || 'No';
            df[i]['Feedback'] = u.Feedback || '';
          } else {
            df.push({
              'SALESMAN': u.SALESMAN || '',
              'CUSTOMER': u.CUSTOMER || '',
              'Customer_code': u.Customer_code || '',
              'Visited': u.Visited || 'No',
              'Feedback': u.Feedback || ''
            });
          }
        });

        const newWs = XLSX.utils.json_to_sheet(df);
        wb.Sheets[wsName] = newWs;
        XLSX.writeFile(wb, 'UPDATED_with_feedback.xlsx');
        showToast('Excel downloaded');
      };
      reader.readAsArrayBuffer(excelFile);
    });

    // initial render
    renderCards();
  </script>
</body>
</html>